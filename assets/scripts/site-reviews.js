!function(){"use strict";let e;const t=function(e){return"json"===this.responseType||!0===this.json?e({message:this.statusText},!1):"text"===this.responseType?e(this.statusText):void console.error(this)},i=function(e){if(0===this.status||this.status>=200&&this.status<300||304===this.status){if("json"===this.responseType)return e(this.response.data,this.response.success);if("text"===this.responseType)return e(this.responseText);if(!0===this.json){const t=JSON.parse(this.response);return e(t.data,t.success)}console.info(this)}else t.bind(this,e)},s=e=>{let t=new FormData;const i=Object.prototype.toString.call(e);return"[object FormData]"===i&&(t=e),"[object HTMLFormElement]"===i&&(t=new FormData(e)),"[object Object]"===i&&Object.keys(e).forEach((i=>t.append(i,e[i]))),t.append("action",GLSR.action),t.append("_ajax_request",!0),t},n=s=>{e=new XMLHttpRequest,e.addEventListener("load",i.bind(e,s)),e.addEventListener("error",t.bind(e,s))},r=t=>{(t=t||{})["X-Requested-With"]="XMLHttpRequest";for(let i in t)t.hasOwnProperty(i)&&e.setRequestHeader(i,t[i])};var a={get:(t,i,s)=>{n(i),e.open("GET",t,!0),e.responseType="text",r(s),e.send()},post:(t,i,a)=>{n(i),e.open("POST",GLSR.ajaxurl,!0),e.responseType="json",e.json=!0,r(a),e.send(s(t))}};const o={},l=function(e,t){const i=o[e]||[],s=[];t&&[].forEach.call(i,(e=>{t!==e.fn&&t!==e.fn.once&&s.push(e)})),s.length?o[e]=s:delete o[e]},c=function(e,t,i){(o[e]||(o[e]=[])).push({fn:t,context:i})};var h={events:o,off:l,on:c,once:function(e,t,i){const s=function(){l(e,s),t.apply(i,arguments)};s.once=t,c(e,s,i)},trigger:function(e){const t=[].slice.call(arguments,1),i=(o[e]||[]).slice();[].forEach.call(i,(e=>e.fn.apply(e.context,t)))}};const d="function",u="isNode",p=(e,t)=>typeof e===t,f=(e,t)=>{null!==t&&(Array.isArray(t)?t.map((t=>f(e,t))):(v[u](t)||(t=document.createTextNode(t)),e.appendChild(t)))};function v(e,t){let i,s,n=arguments,r=1;if(!v.isElement(e)){let t=~["svg","line","path","rect","mask","radialGradient","stop"].indexOf(e)?"2000/svg":"1999/xhtml";e=document.createElementNS(`http://www.w3.org/${t}`,e)}if("string"==typeof t&&(t={class:t}),p(t,"object")&&!v[u](t)&&!Array.isArray(t))for(i in r++,t)s=t[i],i=v.attrMap[i]||i,p(i,d)?i(e,s):p(s,d)?e[i]=s:e.setAttribute(i,s);for(;r<n.length;r++)f(e,n[r]);return e}v.attrMap={},v.isElement=e=>e instanceof Element,v[u]=e=>e instanceof Node;const g="glsr-read-more",m=".glsr-hidden-text",w=".glsr-tag-value";class y{constructor(e){this.events={click:this._onClick.bind(this)},(e||document).querySelectorAll(m).forEach((e=>this.init(e)))}init(e){const t=this._insertLink(e);t&&("expand"===e.dataset.trigger&&(t.dataset.text=e.dataset.showLess,t.removeEventListener("click",this.events.click),t.addEventListener("click",this.events.click)),"modal"===e.dataset.trigger&&(t.dataset.glsrTrigger="glsr-modal-review"))}_insertLink(e){let t=e.parentElement.querySelector("."+g);t&&t.parentElement.removeChild(t);const i=v("a",{href:"#"},e.dataset.showMore),s=v("span",{class:g},i);return e.appendChild(s).querySelector("a")}_onClick(e){e.preventDefault();const t=e.currentTarget,i=t.parentElement,s=t.closest(w),n=s.querySelector(m),r=t.dataset.text,a=t.innerText;t.dataset.text=a,t.innerText=r,t.removeEventListener("click",this.events.click),"false"===s.dataset.expanded?(s.querySelector("p:last-of-type").appendChild(i),s.dataset.expanded=!0):(n.appendChild(i),s.dataset.expanded=!1),t.addEventListener("click",this.events.click),t.focus()}}var _=e=>({el:e,loading:()=>{"false"===e.getAttribute("aria-busy")&&(e.setAttribute("aria-busy",!0),e.setAttribute("disabled",""),e.dataset.text=e.innerText,e.innerHTML='<span class="glsr-loading"></span>'+(e.dataset.loading||e.dataset.text))},loaded:()=>{"true"===e.getAttribute("aria-busy")&&(e.innerHTML=e.dataset.text,e.setAttribute("aria-busy",!1),e.removeAttribute("data-text"),e.removeAttribute("disabled"))}});class b{constructor(e){this.Form=e,this.captcha={friendlycaptcha:"friendlyChallenge",hcaptcha:"hcaptcha",recaptcha_v2_invisible:"grecaptcha",recaptcha_v3:"grecaptcha",turnstile:"turnstile"}[GLSR.captcha.type],this.captchaEl=!1,this.containerEl=this.Form.form.querySelector(".glsr-captcha-holder"),this.loaded=!1,this.token=null,this.widget=-1,this.fixCompatibility()}execute(){if(this.captchaEl&&this.isWidgetLoaded())try{this["execute_"+GLSR.captcha.type]()}catch(e){console.error(e),this.Form.submitForm()}else this.Form.submitForm()}execute_friendlycaptcha(){1==+this.captchaEl.dataset.error?this._submitFormWithToken("sitekey_invalid"):this.token?this.Form.submitForm():setTimeout((()=>this.execute_friendlycaptcha()),100)}execute_hcaptcha(){1==+this.captchaEl.dataset.error?this._submitFormWithToken("sitekey_invalid"):this.token?this._submitFormWithToken(this.token):window[this.captcha].execute(this.widget,{action:"submit_review",async:!0}).then((e=>{let{response:t}=e;this._submitFormWithToken(t)})).catch((e=>{console.error(e)}))}execute_recaptcha_v2_invisible(){this.execute_recaptcha_v3()}execute_recaptcha_v3(){1==+this.captchaEl.dataset.error?this._submitFormWithToken("sitekey_invalid"):window[this.captcha].execute(this.widget,{action:"submit_review"})}execute_turnstile(){let e=window[this.captcha].getResponse(this.widget);1==+this.captchaEl.dataset.error||this.token||void 0===e?this.Form.submitForm():setTimeout((()=>this.execute_turnstile()),100)}fixCompatibility(){"hcaptcha"===GLSR.captcha.type&&void 0!==window.hCaptchaOnLoad&&document.body.click()}isLoaded(e){for(let t=0;t<document.scripts.length;t++)if(e.split("?")[0]===document.scripts[t].src.split("?")[0])return!0;return!1}isWidgetLoaded(){return!~[-1,null,void 0].indexOf(this.widget)}load(e){return new Promise(((t,i)=>{if(void 0===e||this.isLoaded(e))t();else{const s=document.createElement("script");s.onload=t,s.onerror=i,s.src=e,s.type="text/javascript",GLSR.captcha.urls.length>1&&(-1!==e.indexOf("module")?s.type="module":s.setAttribute("nomodule","")),s.setAttribute("defer",""),document.head.append(s)}}))}render(){if(this.Form.form.onsubmit=null,this.containerEl&&!this.isWidgetLoaded())if(void 0===window[this.captcha])this.loaded?setTimeout((()=>this.render()),50):this.load(GLSR.captcha.urls[0]).then((()=>{this.load(GLSR.captcha.urls[1])})).then((()=>this.loaded=!0)).then((()=>setTimeout((()=>this.render()),100))).catch((e=>console.error(e)));else{this.reset(),this._buildContainer();try{this["render_"+GLSR.captcha.type]()}catch(e){this.captchaEl.dataset.error=1,console.error(e)}}}render_friendlycaptcha(){this.widget=new window[this.captcha].WidgetInstance(this.captchaEl,{doneCallback:e=>this.token=e,errorCallback:e=>{console.error(e),this.captchaEl.dataset.error=1}})}render_hcaptcha(){var e;void 0!==(null===(e=window[this.captcha])||void 0===e?void 0:e.render)?this.widget=window[this.captcha].render(this.captchaEl,{callback:e=>this.token=e,"chalexpired-callback":()=>this.reset(),"close-callback":()=>this.Form.button.loaded(),"error-callback":()=>this.captchaEl.dataset.error=1,"expired-callback":()=>this.reset()}):setTimeout((()=>this.render_hcaptcha()),100)}render_recaptcha_v2_invisible(){this.render_recaptcha_v3()}render_recaptcha_v3(){var e;void 0!==(null===(e=window[this.captcha])||void 0===e?void 0:e.render)?this.widget=window[this.captcha].render(this.captchaEl,{callback:e=>this._submitFormWithToken(e),"error-callback":()=>this.captchaEl.dataset.error=1,"expired-callback":()=>this.reset(),isolated:!0}):setTimeout((()=>this.render_recaptcha_v3()),100)}render_turnstile(){this.widget=window[this.captcha].render(this.captchaEl,{action:"submit_review",callback:e=>this.token=e,"error-callback":()=>this.captchaEl.dataset.error=1,"expired-callback":()=>this.reset(),sitekey:GLSR.captcha.sitekey,theme:GLSR.captcha.theme})}reset(){this.token=null,this.captchaEl&&(this.captchaEl.dataset.error=0),this.isWidgetLoaded()&&("friendlycaptcha"===GLSR.captcha.type?this.widget.reset():window[this.captcha].reset(this.widget))}_buildContainer(){"friendlycaptcha"===GLSR.captcha.type&&this.isWidgetLoaded()&&this.widget.destroy(),Array.from(this.containerEl.getElementsByClassName(GLSR.captcha.class)).forEach((e=>e.remove())),this.captchaEl=v("div",{class:GLSR.captcha.class,"data-badge":GLSR.captcha.badge,"data-lang":GLSR.captcha.language,"data-isolated":!0,"data-sitekey":GLSR.captcha.sitekey,"data-size":GLSR.captcha.size,"data-theme":GLSR.captcha.theme}),this.containerEl.appendChild(this.captchaEl)}_submitFormWithToken(e){["frc-captcha-solution","g-recaptcha-response","h-captcha-response"].forEach((t=>{this.Form.form[t]&&e&&(this.Form.form[t].value=e)})),this.Form.submitForm()}}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function S(e,t,i){return t&&L(e.prototype,t),i&&L(e,i),e}var x={classNames:{active:"gl-active",base:"gl-star-rating",selected:"gl-selected"},clearable:!0,maxStars:10,prebuilt:!1,stars:null,tooltip:"Select a Rating"},k=function(e,t,i){e.classList[t?"add":"remove"](i)},R=function(e){var t=document.createElement("span");for(var i in e=e||{})t.setAttribute(i,e[i]);return t},T=function(e,t,i){var s=R(i);return e.parentNode.insertBefore(s,t?e.nextSibling:e),s},G=function e(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];var n={};return i.forEach((function(t){Object.keys(t||{}).forEach((function(s){if(void 0!==i[0][s]){var r=t[s];"Object"!==A(r)||"Object"!==A(n[s])?n[s]=r:n[s]=e(n[s],r)}}))})),n},A=function(e){return{}.toString.call(e).slice(8,-1)},F=function(){function e(t,i){var s,n,r;E(this,e),this.direction=window.getComputedStyle(t,null).getPropertyValue("direction"),this.el=t,this.events={change:this.onChange.bind(this),keydown:this.onKeyDown.bind(this),mousedown:this.onPointerDown.bind(this),mouseleave:this.onPointerLeave.bind(this),mousemove:this.onPointerMove.bind(this),reset:this.onReset.bind(this),touchend:this.onPointerDown.bind(this),touchmove:this.onPointerMove.bind(this)},this.indexActive=null,this.indexSelected=null,this.props=i,this.tick=null,this.ticking=!1,this.values=function(e){var t=[];return[].forEach.call(e.options,(function(e){var i=parseInt(e.value,10)||0;i>0&&t.push({index:e.index,text:e.text,value:i})})),t.sort((function(e,t){return e.value-t.value}))}(t),this.widgetEl=null,this.el.widget&&this.el.widget.destroy(),s=this.values.length,n=1,r=this.props.maxStars,/^\d+$/.test(s)&&n<=s&&s<=r?this.build():this.destroy()}return S(e,[{key:"build",value:function(){this.destroy(),this.buildWidget(),this.selectValue(this.indexSelected=this.selected(),!1),this.handleEvents("add"),this.el.widget=this}},{key:"buildWidget",value:function(){var e,t,i=this;this.props.prebuilt?(e=this.el.parentNode,t=e.querySelector("."+this.props.classNames.base+"--stars")):((e=T(this.el,!1,{class:this.props.classNames.base})).appendChild(this.el),t=T(this.el,!0,{class:this.props.classNames.base+"--stars"}),this.values.forEach((function(e,s){var n=R({"data-index":s,"data-value":e.value});"function"==typeof i.props.stars&&i.props.stars.call(i,n,e,s),[].forEach.call(n.children,(function(e){return e.style.pointerEvents="none"})),t.innerHTML+=n.outerHTML}))),e.dataset.starRating="",e.classList.add(this.props.classNames.base+"--"+this.direction),this.props.tooltip&&t.setAttribute("role","tooltip"),this.widgetEl=t}},{key:"changeIndexTo",value:function(e,t){var i=this;if(this.indexActive!==e||t){if([].forEach.call(this.widgetEl.children,(function(t,s){k(t,s<=e,i.props.classNames.active),k(t,s===i.indexSelected,i.props.classNames.selected)})),this.widgetEl.setAttribute("data-rating",e+1),"function"==typeof this.props.stars||this.props.prebuilt||(this.widgetEl.classList.remove("s"+10*(this.indexActive+1)),this.widgetEl.classList.add("s"+10*(e+1))),this.props.tooltip){var s,n=e<0?this.props.tooltip:null===(s=this.values[e])||void 0===s?void 0:s.text;this.widgetEl.setAttribute("aria-label",n)}this.indexActive=e}this.ticking=!1}},{key:"destroy",value:function(){this.indexActive=null,this.indexSelected=this.selected();var e=this.el.parentNode;e.classList.contains(this.props.classNames.base)&&(this.props.prebuilt?(this.widgetEl=e.querySelector("."+this.props.classNames.base+"--stars"),e.classList.remove(this.props.classNames.base+"--"+this.direction),delete e.dataset.starRating):e.parentNode.replaceChild(this.el,e),this.handleEvents("remove")),delete this.el.widget}},{key:"eventListener",value:function(e,t,i,s){var n=this;i.forEach((function(i){return e[t+"EventListener"](i,n.events[i],s||!1)}))}},{key:"handleEvents",value:function(e){var t=this.el.closest("form");t&&"FORM"===t.tagName&&this.eventListener(t,e,["reset"]),this.eventListener(this.el,e,["change"]),"add"===e&&this.el.disabled||(this.eventListener(this.el,e,["keydown"]),this.eventListener(this.widgetEl,e,["mousedown","mouseleave","mousemove","touchend","touchmove"],!1))}},{key:"indexFromEvent",value:function(e){var t,i,s=(null===(t=e.touches)||void 0===t?void 0:t[0])||(null===(i=e.changedTouches)||void 0===i?void 0:i[0])||e,n=document.elementFromPoint(s.clientX,s.clientY);return n.parentNode===this.widgetEl?[].slice.call(n.parentNode.children).indexOf(n):this.indexActive}},{key:"onChange",value:function(){this.changeIndexTo(this.selected(),!0)}},{key:"onKeyDown",value:function(e){var t=e.key.slice(5);if(~["Left","Right"].indexOf(t)){e.preventDefault();var i="Left"===t?-1:1;"rtl"===this.direction&&(i*=-1);var s=this.values.length-1,n=Math.min(Math.max(this.selected()+i,-1),s);this.selectValue(n,!0)}}},{key:"onPointerDown",value:function(e){e.preventDefault();var t=this.indexFromEvent(e);this.props.clearable&&t===this.indexSelected&&(t=-1),this.selectValue(t,!0)}},{key:"onPointerLeave",value:function(e){var t=this;e.preventDefault(),cancelAnimationFrame(this.tick),requestAnimationFrame((function(){return t.changeIndexTo(t.indexSelected)}))}},{key:"onPointerMove",value:function(e){var t=this;e.preventDefault(),this.ticking||(this.tick=requestAnimationFrame((function(){return t.changeIndexTo(t.indexFromEvent(e))})),this.ticking=!0)}},{key:"onReset",value:function(){var e,t=this.valueIndex(null===(e=this.el.querySelector("[selected]"))||void 0===e?void 0:e.value);this.selectValue(t||-1,!1)}},{key:"selected",value:function(){return this.valueIndex(this.el.value)}},{key:"selectValue",value:function(e,t){var i;this.el.value=(null===(i=this.values[e])||void 0===i?void 0:i.value)||"",this.indexSelected=this.selected(),!1===t?this.changeIndexTo(this.selected(),!0):this.el.dispatchEvent(new Event("change"))}},{key:"valueIndex",value:function(e){return this.values.findIndex((function(t){return t.value===+e}))}}]),e}(),N=function(){function e(t,i){E(this,e),this.destroy=this.destroy.bind(this),this.props=i,this.rebuild=this.rebuild.bind(this),this.selector=t,this.widgets=[],this.build()}return S(e,[{key:"build",value:function(){var e=this;this.queryElements(this.selector).forEach((function(t){var i=G(x,e.props,JSON.parse(t.getAttribute("data-options")));"SELECT"!==t.tagName||t.widget||(!i.prebuilt&&t.parentNode.classList.contains(i.classNames.base)&&e.unwrap(t),e.widgets.push(new F(t,i)))}))}},{key:"destroy",value:function(){this.widgets.forEach((function(e){return e.destroy()})),this.widgets=[]}},{key:"queryElements",value:function(e){return"HTMLSelectElement"===A(e)?[e]:"NodeList"===A(e)?[].slice.call(e):"String"===A(e)?[].slice.call(document.querySelectorAll(e)):[]}},{key:"rebuild",value:function(){this.destroy(),this.build()}},{key:"unwrap",value:function(e){var t=e.parentNode,i=t.parentNode;i.insertBefore(e,t),i.removeChild(t)}}]),e}();const M={classNames:{base:"glsr-star-rating"},clearable:!1,tooltip:!1};const O=(e,t,i)=>{e&&t.split(" ").forEach((t=>{e.classList[i?"add":"remove"](t)}))},C=e=>"."+e.trim().split(" ").join("."),P=e=>{let t='input[name="'+e.getAttribute("name")+'"]:checked';return e.validation.form.querySelectorAll(t).length},q={email:{fn:function(e){return!e||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}},max:{fn:function(e,t){return!e||("checkbox"===this.type?P(this)<=parseInt(t):parseFloat(e)<=parseFloat(t))}},maxlength:{fn:function(e,t){return!e||e.length<=parseInt(t)}},min:{fn:function(e,t){return!e||("checkbox"===this.type?P(this)>=parseInt(t):parseFloat(e)>=parseFloat(t))}},minlength:{fn:function(e,t){return!e||e.length>=parseInt(t)}},number:{fn:function(e){return!e||!isNaN(parseFloat(e))},priority:2},pattern:{fn:function(e,t){let i=t.match(new RegExp("^/(.*?)/([gimy]*)$"));return!e||new RegExp(i[1],i[2]).test(e)}},required:{fn:function(e){return"radio"===this.type||"checkbox"===this.type?P(this):void 0!==e&&""!==e},priority:99,halt:!0},tel:{fn:function(e){let t=e.replace(/[^0-9]/g,"").length;return!e||4<=t&&15>=t&&new RegExp("^[+]?[\\d\\s()-]*$").test(e)}},url:{fn:function(e){return!e||new RegExp("^(https?)://([\\p{L}\\p{N}\\p{S}\\-_.])+(.?([\\p{L}\\p{N}]|xn--[\\p{L}\\p{N}\\-]+)+.?)(:[0-9]+)?(?:/(?:[\\p{L}\\p{N}\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})*)*(?:\\?(?:[\\p{L}\\p{N}\\-._~!$&'\\[\\]()*+,;=:@/?]|%[0-9A-Fa-f]{2})*)?(?:#(?:[\\p{L}\\p{N}\\-._~!$&'()*+,;=:@/?]|%[0-9A-Fa-f]{2})*)?$","iu").test(e)}}},j=["required","max","maxlength","min","minlength","pattern"];class H{constructor(e){this.config=GLSR.validationconfig,this.fields=[],this.form=e,this.form.setAttribute("novalidate",""),this.strings=GLSR.validationstrings,this.validateEvent=this._onChange.bind(this)}destroy(){for(this.reset();this.fields.length;){const e=this.fields.shift();this._removeEvent(e.input),delete e.input.validation}}init(){this.form.querySelectorAll("input:not([type^=hidden]):not([type^=submit]), select, textarea, [data-glsr-validate]").forEach((e=>{if(this.fields.find((t=>t.input.name===e.name&&!e.name.endsWith("[]"))))return;let t=e.closest(C(this.config.field));t&&"none"!==t.style.display&&this.fields.push(this._initField(e))}))}reset(){for(let e in this.fields){if(!this.fields.hasOwnProperty(e))continue;this.fields[e].errorElements=null;let t=this.fields[e].input.closest(C(this.config.field));O(this.fields[e].input,this.config.input_error,!1),O(this.fields[e].input,this.config.input_valid,!1),O(t,this.config.field_error,!1),O(t,this.config.field_valid,!1)}}setErrors(e,t){e.hasOwnProperty("validation")&&this._initField(e),e.validation.errors=t}toggleError(e,t){let i=e.input.closest(C(this.config.field));if(O(e.input,this.config.input_error,t),O(e.input,this.config.input_valid,!t),i){O(i,this.config.field_error,t),O(i,this.config.field_valid,!t);let s=i.querySelector(C(this.config.field_message));s&&(s.innerHTML=t?e.errors.join("<br>"):"",s.style.display=t?"":"none")}}validate(e){let t=!0,i=this.fields;e instanceof HTMLElement&&(i=[e.validation]);for(let e in i){if(!i.hasOwnProperty(e))continue;const s=i[e];this._validateField(s)?this.toggleError(s,!1):(t=!1,this.toggleError(s,!0))}return t}_addEvent(e){e.addEventListener(this._getEventName(e),this.validateEvent)}_addValidators(e,t,i){[].forEach.call(e,(e=>{let s=e.name.replace("data-","");~j.indexOf(s)?this._addValidatorToField(t,i,s,e.value):"type"===e.name&&this._addValidatorToField(t,i,e.value)}))}_addValidatorToField(e,t,i,s){if(q[i]&&(q[i].name=i,e.push(q[i]),s)){var n="pattern"===i?[s]:s.split(",");n.unshift(null),t[i]=n}}_onChange(e){this.validate(e.currentTarget)}_removeEvent(e){e.removeEventListener(this._getEventName(e),this.validateEvent)}_getEventName(e){return~["radio","checkbox"].indexOf(e.getAttribute("type"))||"SELECT"===e.nodeName?"change":"input"}_initField(e){let t={},i=[];return null!==e.offsetParent&&(this._addValidators(e.attributes,i,t),this._sortValidators(i),this._addEvent(e)),e.validation={form:this.form,input:e,params:t,validate:()=>this.validate(e),validators:i}}_sortValidators(e){e.sort(((e,t)=>(t.priority||1)-(e.priority||1)))}_validateField(e){let t=[],i=!0;for(let s in e.validators){if(!e.validators.hasOwnProperty(s))continue;let n=e.validators[s],r=e.params[n.name]?e.params[n.name]:[];if(r[0]=e.input.value,!n.fn.apply(e.input,r)){i=!1;let e=this.strings[n.name];if(t.push(e.replace(/(\%s)/g,r[1])),!0===n.halt)break}}return e.errors=t,i}}class ${constructor(e,t){var i,s;this.button=_(t),this.config=GLSR.validationconfig,this.events={submit:this._onSubmit.bind(this)},this.form=e,this.isActive=!1,this.stars=(()=>{let e=null;const t=()=>!!e&&(e.rebuild(),!0);return{init:function(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t()||(e=new N(i,Object.assign({},M,s))),e},destroy:()=>!!e&&(e.destroy(),!0),rebuild:t}})(),this.strings=GLSR.validationstrings,this.captcha=new b(this),this.validation=new H(e),this.reviewsEl=document.getElementById(null===(i=e.closest(".glsr"))||void 0===i||null===(s=i.dataset)||void 0===s?void 0:s.reviews_id)}destroy(){this._destroyForm(),this.stars.destroy(),this.captcha.reset(),this.isActive=!1}init(){this.isActive||(this._initForm(),this.stars.init(this.form.querySelectorAll(".glsr-field-rating select"),GLSR.starsconfig),this.captcha.render(),this.isActive=!0)}submitForm(){this.button.loading(),GLSR.ajax.post(this._data(),this._handleResponse.bind(this))}_data(){const e=new FormData(this.form);if(this.reviewsEl&&this.reviewsEl.classList.contains("glsr"))try{const t=JSON.parse(JSON.stringify(this.reviewsEl.dataset));for(let i of Object.keys(t)){let s;try{s=JSON.parse(t[i])}catch(e){s=t[i]}e.append(`${GLSR.nameprefix}[_reviews_atts][${i}]`,s)}e.append([`${GLSR.nameprefix}[_pagination_atts][page]`],1),e.append([`${GLSR.nameprefix}[_pagination_atts][url]`],location.href)}catch(e){console.error(e)}return e}_destroyForm(){this.form.removeEventListener("submit",this.events.submit),this._resetErrors(),this.validation.destroy()}_handleResponse(e,t){const i=!0===t;if(this.captcha.reset(),i&&this.form.reset(),this._showFieldErrors(e.errors),this._showResults(e.message,i),this.button.loaded(),GLSR.Event.trigger("site-reviews/form/handle",e,this.form),i){if(e.redirect&&""!==e.redirect)return void(window.location=e.redirect);if(this.reviewsEl&&e.reviews){if(this.reviewsEl.innerHTML=e.reviews,GLSR.urlparameter){let e=new URL(location.href);e.searchParams.delete(GLSR.urlparameter),window.history.replaceState({},"",e.toString())}GLSR.Event.trigger("site-reviews/pagination/init")}}}_initForm(){this._destroyForm(),this.form.addEventListener("submit",this.events.submit),this.validation.init()}_onSubmit(e){if(!this.validation.validate())return e.preventDefault(),void this._showResults(this.strings.errors,!1);e.preventDefault(),this._resetErrors(),this.button.loading(),this.captcha.execute()}_resetErrors(){O(this.form,this.config.form_error,!1),this._showResults("",null),this.validation.reset()}_showFieldErrors(e){if(e)for(let t in e){if(!e.hasOwnProperty(t))continue;const i=GLSR.nameprefix?GLSR.nameprefix+"["+t+"]":t,s=this.form.querySelector('[name="'+i+'"]');s&&(this.validation.setErrors(s,e[t]),this.validation.toggleError(s.validation,"add"))}}_showResults(e,t){const i=this.form.querySelector(C(this.config.form_message));null!==i&&(O(this.form,this.config.form_error,!1===t),O(i,this.config.form_message_failed,!1===t),O(i,this.config.form_message_success,!0===t),i.innerHTML=e)}}var D=function(){return"undefined"==typeof window},I=function(e){e=e||navigator.userAgent;var t=/(iPad).*OS\s([\d_]+)/.test(e);return{ios:!t&&/(iPhone\sOS)\s([\d_]+)/.test(e)||t,android:/(Android);?[\s/]+([\d.]+)?/.test(e)}};var W=0,V=0,Y=0,J=null,B=!1,K=[],X=function(e){if(D())return!1;if(!e)throw new Error("options must be provided");var t=!1,i={get passive(){t=!0}},s=function(){},n="__TUA_BSL_TEST_PASSIVE__";window.addEventListener(n,s,i),window.removeEventListener(n,s,i);var r=e.capture;return t?e:void 0!==r&&r}({passive:!1}),z=!D()&&"scrollBehavior"in document.documentElement.style,U=function(e){e.cancelable&&e.preventDefault()},Q=function(e){e||null!==e&&"production"!==process.env.NODE_ENV&&console.warn("If scrolling is also required in the floating layer, the target element must be provided.")},Z=function(e,t){if(!D()){if(Q(e),I().ios){if(e)(Array.isArray(e)?e:[e]).forEach((function(e){e&&-1===K.indexOf(e)&&(e.ontouchstart=function(e){V=e.targetTouches[0].clientY,Y=e.targetTouches[0].clientX},e.ontouchmove=function(t){1===t.targetTouches.length&&function(e,t){if(t){var i=t.scrollTop,s=t.scrollLeft,n=t.scrollWidth,r=t.scrollHeight,a=t.clientWidth,o=t.clientHeight,l=e.targetTouches[0].clientX-Y,c=e.targetTouches[0].clientY-V,h=Math.abs(c)>Math.abs(l);if(h&&(c>0&&0===i||c<0&&i+o+1>=r)||!h&&(l>0&&0===s||l<0&&s+a+1>=n))return U(e)}e.stopPropagation()}(t,e)},K.push(e))}));B||(document.addEventListener("touchmove",U,X),B=!0)}else W<=0&&(J=I().android?function(e){var t=document.documentElement,i=document.body,s=t.scrollTop||i.scrollTop,n=Object.assign({},t.style),r=Object.assign({},i.style);return t.style.height="100%",t.style.overflow="hidden",i.style.top="-".concat(s,"px"),i.style.width="100%",i.style.height="auto",i.style.position="fixed",i.style.overflow=(null==e?void 0:e.overflowType)||"hidden",function(){t.style.height=n.height||"",t.style.overflow=n.overflow||"",["top","width","height","overflow","position"].forEach((function(e){i.style[e]=r[e]||""}));var e={top:s,behavior:"instant"};z?window.scrollTo(e):window.scrollTo(0,s)}}(t):(i=document.documentElement,s=Object.assign({},i.style),n=window.innerWidth-i.clientWidth,r=parseInt(window.getComputedStyle(i).paddingRight,10),i.style.overflow="hidden",i.style.boxSizing="border-box",i.style.paddingRight="".concat(n+r,"px"),function(){["overflow","boxSizing","paddingRight"].forEach((function(e){i.style[e]=s[e]||""}))}));var i,s,n,r;W+=1}};const ee=["[contenteditable]",'[tabindex]:not([tabindex^="-"])',"a[href]","button:not([disabled]):not([aria-hidden])",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])"],te={focus:!1,onClose:()=>{},onOpen:()=>{}},ie="data-glsr-close",se="glsr-modal",ne="is-open",re="data-glsr-trigger",ae=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.class=se+"__"+e,t};class oe{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.events={_open:this._openModal.bind(this),mouseup:this._onClick.bind(this),keydown:this._onKeydown.bind(this),touchstart:this._onClick.bind(this)},this.id=e,this.triggers=[],this._config(t),this._reset()}_closeModal(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;var t;e&&(e.preventDefault(),e.stopPropagation()),this.root.setAttribute("aria-hidden","true"),this._eventHandler("remove"),t=this.content,D()||(Q(t),(W-=1)>0)||(I().ios||"function"!=typeof J?(t&&(Array.isArray(t)?t:[t]).forEach((function(e){var t=K.indexOf(e);-1!==t&&(e.ontouchmove=null,e.ontouchstart=null,K.splice(t,1))})),B&&(document.removeEventListener("touchmove",U,X),B=!1)):J()),this.trigger&&this.trigger.focus&&this.trigger.focus();const i=()=>{this.root.removeEventListener("animationend",i,!1),this.root.classList.remove(ne),ce.pop(),this.config.onClose(this,e),GLSR.Event.trigger("site-reviews/modal/close",this.root,this.trigger,e),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,i=null;return function(){clearTimeout(i);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];i=setTimeout(e,t,...n)}}((()=>this._reset()))()};this.root.addEventListener("animationend",i,!1)}_config(e){return this.config=Object.assign({},te,e),this}_eventHandler(e){this._eventListener(this.close,e,["keydown"]),this._eventListener(this.root,e,["mouseup","touchstart"]),this._eventListener(document,e,["keydown"])}_eventListener(e,t,i){e&&i.forEach((i=>e[t+"EventListener"](i,this.events[i])))}_focusableNodes(){return[].slice.call(this.root.querySelectorAll(ee))}_insertModal(){const e=v("button",ae("close",{"aria-label":GLSR.text.closemodal,"data-glsr-close":""})),t=v("div",ae("content",{tabindex:-1})),i=v("div",ae("header")),s=v("div",ae("footer")),n=v("div",{class:se,id:this.id,"aria-hidden":!0},v("div",ae("overlay",{tabindex:-1,"data-glsr-close":""}),v("div",ae("dialog",{"aria-modal":!0,role:"dialog"}),e,i,t,s)));this.close=e,this.content=t,this.footer=s,this.header=i,this.root=document.body.appendChild(n)}_onClick(e){e.target.hasAttribute(ie)&&this._closeModal(e)}_onKeydown(e){~[13,32].indexOf(e.keyCode)&&e.target===this.close&&this._closeModal(e),27===e.keyCode&&ce.slice(-1)[0]===this.id&&this._closeModal(e),9===e.keyCode&&this._retainFocus(e)}_openModal(e){ce.push(this.id),this.trigger=document.activeElement,e&&(e.preventDefault(),this.trigger=e.currentTarget),this._insertModal(),Z(this.content),this.config.onOpen(this,e),GLSR.Event.trigger("site-reviews/modal/open",this.root,this.trigger,e),this.root.setAttribute("aria-hidden","false"),this.root.classList.add(ne),this._eventHandler("add");const t=()=>{this.root.removeEventListener("animationend",t,!1),this._setFocusToFirstNode()};this.root.addEventListener("animationend",t,!1)}_registerTrigger(e){this._removeTrigger(e),e.addEventListener("click",this.events._open),this.triggers.push(e)}_removeTrigger(e){this.triggers.filter((t=>t!==e)),e.removeEventListener("click",this.events._open)}_removeTriggers(){this.triggers.forEach((e=>this._removeTrigger(e))),this.triggers=[]}_reset(){this.root&&this.root.remove(),this.close=null,this.content=null,this.footer=null,this.header=null,this.root=null,this.trigger=null}_retainFocus(e){let t=this._focusableNodes();if(0!==t.length)if(t=t.filter((e=>null!==e.offsetParent)),this.root.contains(document.activeElement)){const i=t.indexOf(document.activeElement);e.shiftKey&&0===i?(t[t.length-1].focus(),e.preventDefault()):!e.shiftKey&&t.length>0&&i===t.length-1&&(t[0].focus(),e.preventDefault())}else t[0].focus()}_setFocusToFirstNode(){if(!this.config.focus)return;const e=this._focusableNodes();if(0===e.length)return;const t=e.filter((e=>!e.hasAttribute(ie)));t.length>0?t[0].focus():0===t.length&&e[0].focus()}}const le={},ce=[];var he={close:e=>{if(e)le[e]&&le[e]._closeModal();else for(let e in le)le[e]._closeModal()},init:(e,t)=>{let i;return le[e]?(i=le[e],i._removeTriggers(),t&&i._config(t)):i=new oe(e,t),document.querySelectorAll("["+re+"]").forEach((t=>{e===t.attributes[re].value&&i._registerTrigger(t)})),le[e]=i,le},open:(e,t)=>{let i;le[e]?(i=le[e],i.root&&i._eventHandler("remove"),t&&i._config(t)):i=new oe(e,t),le[e]=i,i._openModal()}};const de="glsr-hide",ue=16,pe=468,fe="button.glsr-button-loadmore",ve=".glsr-pagination a[data-page]",ge=".glsr-reviews, [data-reviews]";class me{constructor(e,t){this.events={button:{click:this._onLoadMore.bind(this)},link:{click:this._onPaginate.bind(this)},window:{popstate:this._onPopstate.bind(this)}},this.paginationEl=t,this.reviewsEl=e.querySelector(ge),this.wrapperEl=e}destroy(){this._eventHandler("remove")}init(){this._eventHandler("add");const e=this.paginationEl.querySelector(".current");if(e){const t=this._data(e),i=e.nextElementSibling;t&&i&&2==+i.dataset.page&&GLSR.urlparameter&&window.history.replaceState(t,"",window.location)}}_data(e){try{const i=JSON.parse(JSON.stringify(this.paginationEl.dataset)),s={};for(var t of Object.keys(i)){let e;try{e=JSON.parse(i[t])}catch(s){e=i[t]}s[`${GLSR.nameprefix}[atts][${t}]`]=e}return s[`${GLSR.nameprefix}[_action]`]="fetch-paged-reviews",s[`${GLSR.nameprefix}[page]`]=e.dataset.page||1,s[`${GLSR.nameprefix}[schema]`]=!1,s[`${GLSR.nameprefix}[url]`]=e.href||location.href,s}catch(e){return console.error("Invalid pagination config."),!1}}_eventHandler(e){this._eventListener(window,e,this.events.window),this.wrapperEl.querySelectorAll(fe).forEach((t=>{this._eventListener(t,e,this.events.button)})),this.wrapperEl.querySelectorAll(ve).forEach((t=>{this._eventListener(t,e,this.events.link)}))}_eventListener(e,t,i){Object.keys(i).forEach((s=>e[t+"EventListener"](s,i[s])))}_handleLoadMore(e,t,i,s){s?(e.loaded(),this.destroy(),this.paginationEl.innerHTML=i.pagination,this.reviewsEl.insertAdjacentHTML("beforeend",i.reviews),this.init(),GLSR.Event.trigger("site-reviews/pagination/handle",i,this)):window.location=location}_handlePagination(e,t,i,s){s?(this._paginate(i),GLSR.urlparameter&&window.history.pushState(t,"",e.href)):window.location=e.href}_handlePopstate(e,t,i){i?this._paginate(t):console.error(t)}_loaded(){const e=this.paginationEl.querySelector(".glsr-spinner");e&&this.paginationEl.removeChild(e),this.wrapperEl.classList.remove(de)}_loading(){this.wrapperEl.classList.add(de),this.paginationEl.insertAdjacentHTML("beforeend",'<div class="glsr-spinner"></div>')}_onLoadMore(e){const t=e.currentTarget,i=this._data(t);if(i){const s=_(t);s.loading(),e.preventDefault(),GLSR.ajax.post(i,this._handleLoadMore.bind(this,s,i))}}_onPaginate(e){const t=e.currentTarget,i=this._data(t);i&&(this._loading(),e.preventDefault(),GLSR.ajax.post(i,this._handlePagination.bind(this,t,i)))}_onPopstate(e){GLSR.Event.trigger("site-reviews/pagination/popstate",e,this),e.state&&e.state[`${GLSR.nameprefix}[_action]`]&&(this._loading(),GLSR.ajax.post(e.state,this._handlePopstate.bind(this,e.state)))}_paginate(e){this.destroy(),this.paginationEl.innerHTML=e.pagination,this.reviewsEl.innerHTML=e.reviews,this.init(),this._scrollToTop(),this._loaded(),GLSR.Event.trigger("site-reviews/pagination/handle",e,this)}_scrollStep(e){const t=Math.min(1,(window.performance.now()-e.startTime)/pe),i=.5*(1-Math.cos(Math.PI*t)),s=e.startY+(e.endY-e.startY)*i;window.scroll(0,e.offset+s),s!==e.endY&&window.requestAnimationFrame(this._scrollStep.bind(this,e))}_scrollToTop(){let e=ue;[].forEach.call(GLSR.ajaxpagination,(t=>{const i=document.querySelector(t);i&&"fixed"===window.getComputedStyle(i).getPropertyValue("position")&&(e+=i.clientHeight)}));const t=this.reviewsEl.getBoundingClientRect().top-e;t>0||this._scrollStep({endY:t,offset:window.pageYOffset,startTime:window.performance.now(),startY:this.reviewsEl.scrollTop})}}const we="function",ye="isNode",_e=(e,t)=>typeof e===t,be=(e,t)=>{null!==t&&(Array.isArray(t)?t.map((t=>be(e,t))):(Ee[ye](t)||(t=document.createTextNode(t)),e.appendChild(t)))};function Ee(e,t){let i,s,n=arguments,r=1;if(!Ee.isElement(e)){let t=~["svg","line","path","rect","mask","radialGradient","stop"].indexOf(e)?"2000/svg":"1999/xhtml";e=document.createElementNS(`http://www.w3.org/${t}`,e)}if("string"==typeof t&&(t={class:t}),_e(t,"object")&&!Ee[ye](t)&&!Array.isArray(t))for(i in r++,t)s=t[i],i=Ee.attrMap[i]||i,_e(i,we)?i(e,s):_e(s,we)?e[i]=s:e.setAttribute(i,s);for(;r<n.length;r++)be(e,n[r]);return e}Ee.attrMap={},Ee.isElement=e=>e instanceof Element,Ee[ye]=e=>e instanceof Node;const Le="site-reviews/excerpts/init",Se="site-reviews/forms/init",xe="site-reviews/init",ke="site-reviews/loaded",Re="site-reviews/modal/init",Te="site-reviews/pagination/init";window.hasOwnProperty("GLSR")||(window.GLSR={}),window.GLSR.ajax=a,window.GLSR.forms=[],window.GLSR.pagination=[],window.GLSR.Event=h,window.GLSR.Modal=he,window.GLSR.Utils={debounce:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,i=null;return function(){clearTimeout(i);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];i=setTimeout(e,t,...n)}},dom:Ee},h.on(Le,(e=>{new y(e),h.trigger(Re)})),h.on(Se,(()=>{GLSR.forms=GLSR.forms.filter((e=>!!e.form.closest("body"))),document.querySelectorAll("form.glsr-review-form").forEach((e=>{const t=e.querySelector("[type=submit]");if(t){let i,s=GLSR.forms.findIndex((t=>t.form===e));-1!==s?(i=GLSR.forms[s],i.destroy()):(i=new $(e,t),GLSR.forms.push(i)),i.init()}}))})),h.on(Re,(()=>{GLSR.Modal.init("glsr-modal-review",{onOpen:e=>{const t=e.trigger.closest(".glsr").cloneNode(!0),i=e.trigger.closest(".glsr-review").cloneNode(!0);i.querySelectorAll('[data-expanded="false"]').forEach((e=>{e.dataset.expanded="true"})),t.innerHTML="",t.appendChild(i),e.content.appendChild(t)}})})),h.on(Te,(()=>{GLSR.pagination.forEach((e=>e.destroy())),GLSR.pagination=[],document.querySelectorAll(".glsr").forEach((e=>{const t=e.querySelector(".glsr-pagination");if(t&&(t.classList.contains("glsr-ajax-loadmore")||t.classList.contains("glsr-ajax-pagination"))){const i=new me(e,t);i.init(),GLSR.pagination.push(i)}}))})),h.on(xe,(()=>{document.querySelectorAll(".glsr").forEach((e=>{const t="glsr-"+window.getComputedStyle(e,null).getPropertyValue("direction");e.classList.add(t)})),h.trigger(Le),h.trigger(Se),h.trigger(Te),h.trigger(ke)})),h.on("site-reviews/pagination/handle",((e,t)=>{h.trigger(Le,t.wrapperEl)})),document.addEventListener("DOMContentLoaded",(()=>{setTimeout((()=>h.trigger(xe)),5),setTimeout((()=>(()=>{let e=new URL(location.href);if(!e.searchParams.has("review_id")||!e.searchParams.has("verified"))return;let t={[`${GLSR.nameprefix}[_action]`]:"verified-review",[`${GLSR.nameprefix}[post_id]`]:e.searchParams.get("review_id"),[`${GLSR.nameprefix}[token]`]:e.searchParams.get("verified")};e.searchParams.has("form")&&(t[`${GLSR.nameprefix}[form]`]=e.searchParams.get("form")),e.searchParams.has("theme")&&(t[`${GLSR.nameprefix}[theme]`]=e.searchParams.get("theme")),GLSR.ajax.post(t,((e,i)=>{i?GLSR.Modal.open("glsr-modal-review",{onOpen:t=>{const i=Ee("p",{style:"background:rgb(240,253,244); border-radius:6px; color:rgb(22,101,52); margin:0; padding:1em;"}),s=Ee("div",{style:"margin:0 1.5em 1.5em;"},i),n=Ee("div",e.attributes);i.innerHTML=e.message,n.innerHTML=e.review,n.querySelectorAll('[data-expanded="false"]').forEach((e=>{e.dataset.expanded="true"})),t.content.appendChild(n),t.footer.appendChild(s)}}):console.error({request:t,response:e})}))})()),10)}))}();
