!function(){"use strict";var e,t={n:function(e){var s=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(s,{a:s}),s},d:function(e,s){for(var n in s)t.o(s,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:s[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},s=window.wp.apiFetch,n=t.n(s),i=window.wp.i18n,r=window.wp.components,a=window.wp.element,o=window.ReactJSXRuntime,l=({endpoint:e,onChange:t,placeholder:s,value:l,...c})=>{const[d,p]=(0,a.useState)(!1),[u,m]=(0,a.useState)([]),v=(0,a.useRef)(!0),x=Object.fromEntries(Object.entries(c).filter((([e])=>!["onChange","placeholder","value"].includes(e)))),h=async(t="")=>{p(!0);try{const s=new URL(e,window.location.origin);s.searchParams.set("include",l.join(",")),s.searchParams.set("search",t);const i=await n()({path:s.pathname+s.search});if(v.current){if(!Array.isArray(i)||0===i.length)throw new Error("Invalid or empty response from API");m(i)}}catch(e){console.error("Error fetching options:",e)}finally{v.current&&p(!1)}};return(0,a.useEffect)((()=>(h(),()=>{v.current=!1})),[]),(0,o.jsx)(r.BaseControl,{__nextHasNoMarginBottom:!0,children:(0,o.jsx)(r.FormTokenField,{__experimentalExpandOnFocus:!0,__experimentalShowHowTo:!1,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,onChange:e=>{const s=e.map((e=>{const t=u.find((t=>t.title===e));return t?t.id:null})).filter((e=>null!==e));t(s)},onInputChange:h,placeholder:d?(0,i._x)("Loading...","admin-text","site-reviews"):s||(0,i._x)("Select...","admin-text","site-reviews"),suggestions:u.map((e=>e.title)),value:l.map((e=>{const t=u.find((t=>t.id===e));return t?t.title:""})).filter((e=>""!==e)),...x})})},c=window.wp.data,d=({endpoint:e,onChange:t,value:s=[],...i})=>{const[l,d]=(0,a.useState)(!1),{baseControlProps:p,controlProps:u}=(0,r.useBaseControlProps)(i),{setOptions:m}=(0,c.useDispatch)("site-reviews"),v=(0,c.useSelect)((t=>t("site-reviews").getOptions(e)),[e]),x=Object.fromEntries(Object.entries(u).filter((([e])=>!["label","checked","onChange","value"].includes(e))));return(0,a.useEffect)((()=>{v||(async()=>{d(!0);try{const t=new URL(e,window.location.origin),s=await n()({path:t.pathname+t.search});if(!Array.isArray(s)||0===s.length)throw new Error("Invalid or empty response from API");const i=s.map((e=>({label:e.title,value:e.id})));m(e,i)}catch(e){console.error("Error fetching options:",e)}finally{d(!1)}})()}),[e,v,m]),(0,o.jsxs)(r.BaseControl,{__nextHasNoMarginBottom:!0,...p,children:[l&&(0,o.jsx)(r.Spinner,{}),!l&&v&&v.map((e=>(0,o.jsx)(r.ToggleControl,{__nextHasNoMarginBottom:!0,label:e.label,checked:s.includes(e.value),onChange:n=>((e,n)=>{const i=n?[...s,e]:s.filter((t=>t!==e));t(i)})(e.value,n),...x},e.value)))]})},p=window.wp.serverSideRender,u=t.n(p),m=window.wp.blockEditor,v=({className:e="ssr",inspectorAdvancedControls:t={},inspectorControls:s={},name:n,namespace:l="site-reviews",props:c,renderCallback:d})=>{const{attributes:p}=c,v=(0,a.useRef)(null),x=(0,a.useCallback)((t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)if("DIV"===t.tagName&&t.classList.contains(e)){if("function"==typeof d){const e=t.firstElementChild;e.classList.add("glsr-"+window.getComputedStyle(e,null).getPropertyValue("direction")),d(t,v.current)}return}}),[d]);(0,a.useEffect)((()=>{if(!v.current)return;const e=new MutationObserver(x);return e.observe(v.current,{childList:!0,subtree:!0}),()=>e.disconnect()}),[x]);const h={panel_settings:(0,o.jsx)(r.PanelBody,{title:(0,i._x)("Settings","admin-text","site-reviews"),children:Object.values(wp.hooks.applyFilters(`${l}.${n}.InspectorControls`,s,c))})};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(m.InspectorControls,{children:Object.values(wp.hooks.applyFilters(`${l}.${n}.InspectorPanels`,h,c))}),(0,o.jsx)(m.InspectorAdvancedControls,{children:Object.values(wp.hooks.applyFilters(`${l}.${n}.InspectorAdvancedControls`,t,c))}),(0,o.jsx)("div",{...(0,m.useBlockProps)({ref:v}),children:(0,o.jsx)(r.Disabled,{isDisabled:!0,children:(0,o.jsx)(u(),{attributes:p,block:`${l}/${n}`,className:e,skipBlockSupportAttributes:!0})})})]})},x=JSON.parse('{"UU":"site-reviews/summary"}'),h=window.wp.blocks,w=window.React;function g(){return g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)({}).hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},g.apply(null,arguments)}const _=t=>w.createElement("svg",g({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},t),e||(e=w.createElement("path",{d:"M20.694 18.429c.406 0 .735.336.735.75v1.5c0 .414-.329.75-.735.75H3.306a.743.743 0 0 1-.735-.75v-1.5c0-.414.329-.75.735-.75zm-.513 1.071H6.39c-.097 0-.176.064-.176.143v.571c0 .079.079.143.176.143h13.79c.097 0 .176-.064.176-.143v-.571c0-.079-.079-.143-.176-.143zm.513-4.929c.406 0 .735.336.735.75v1.5c0 .414-.329.75-.735.75H3.306a.743.743 0 0 1-.735-.75v-1.5c0-.414.329-.75.735-.75zm-.527 1.188H8.976c-.105 0-.19.064-.19.143v.571c0 .079.085.143.19.143h11.192c.105 0 .19-.064.19-.143v-.571c0-.079-.085-.143-.19-.143zm.527-5.045c.406 0 .735.336.735.75v1.5c0 .414-.329.75-.735.75H3.306a.743.743 0 0 1-.735-.75v-1.5c0-.414.329-.75.735-.75zm-.551 1.071h-2.571c-.118 0-.214.064-.214.143v.571c0 .079.096.143.214.143h2.571c.118 0 .214-.064.214-.143v-.571c0-.079-.096-.143-.214-.143M6.944 1.786l-.083 1.678-3.253.062V5.37c.083-.041.166-.083.269-.104l.332-.083.174-.028.08-.009.078-.004c.104 0 .228-.021.332-.021q.652 0 1.119.186a2 2 0 0 1 .767.518c.207.228.373.456.477.746s.145.58.145.87c0 .394-.062.746-.207 1.057s-.352.559-.622.767a2.6 2.6 0 0 1-.85.456 3.2 3.2 0 0 1-.974.145c-.352 0-.663-.041-.912-.124s-.497-.207-.684-.332-.311-.29-.414-.456-.145-.332-.145-.497a.8.8 0 0 1 .062-.311 1 1 0 0 1 .145-.249c.062-.083.145-.124.228-.186s.186-.062.29-.062q.186 0 .311.062c.125.062.145.104.207.166a.3.3 0 0 1 .07.114l.033.114c.021.083.041.145.041.228 0 .062 0 .124-.021.207s-.062.145-.104.207c.021.062.083.124.124.166s.145.083.207.124.166.062.249.083a1 1 0 0 0 .228.021 1.1 1.1 0 0 0 .539-.124c.145-.083.249-.207.352-.352s.145-.29.186-.456a2.3 2.3 0 0 0 .062-.539v-.352q0-.186-.062-.373c-.021-.145-.062-.269-.104-.394s-.145-.249-.228-.332-.207-.186-.332-.249-.311-.104-.518-.104c-.145 0-.332.041-.539.083s-.456.166-.705.311l-.435-.352-.041-3.461h2.694c.124 0 .228 0 .311-.021s.186-.041.269-.104.104-.104.145-.207a.9.9 0 0 0 .062-.332h.642zm5.203-.293a.22.22 0 0 1 .207.141l1.083 2.594 2.814.225a.22.22 0 0 1 .194.154l.035.11c.03.085.004.18-.066.238l-2.123 1.823.652 2.735a.23.23 0 0 1-.084.233l-.128.07a.22.22 0 0 1-.247 0L12.09 8.364 9.681 9.83a.22.22 0 0 1-.247 0l-.097-.066a.23.23 0 0 1-.084-.233l.634-2.753-2.123-1.823a.22.22 0 0 1-.079-.238l.035-.11a.215.215 0 0 1 .194-.154l2.814-.225 1.079-2.594a.22.22 0 0 1 .192-.141z"}))),f={cachedOptions:{}},b={setOptions(e,t){return{type:"SET_OPTIONS",endpoint:e,options:t}}},C={getOptions(e,t){return e.cachedOptions[t]||null}};(0,c.select)("site-reviews")||(0,c.registerStore)("site-reviews",{actions:b,reducer:(e=f,t)=>"SET_OPTIONS"===t.type?{...e,cachedOptions:{...e.cachedOptions,[t.endpoint]:t.options}}:e,selectors:C}),(0,h.registerBlockType)(x.UU,{edit:function(e){const{attributes:t,setAttributes:s}=e;s({post_id:jQuery("#post_ID").val()});const n={assigned_posts:(0,o.jsx)(l,{endpoint:"/site-reviews/v1/shortcode/site_reviews_summary?option=assigned_posts",label:(0,i._x)("Limit Reviews by Assigned Pages","admin-text","site-reviews"),onChange:e=>s({assigned_posts:e}),placeholder:(0,i._x)("Select a Page...","admin-text","site-reviews"),value:t.assigned_posts},"assigned_posts"),assigned_terms:(0,o.jsx)(l,{endpoint:"/site-reviews/v1/shortcode/site_reviews_summary?option=assigned_terms",label:(0,i._x)("Limit Reviews by Categories","admin-text","site-reviews"),onChange:e=>s({assigned_terms:e}),placeholder:(0,i._x)("Select a Category...","admin-text","site-reviews"),value:t.assigned_terms},"assigned_terms"),assigned_users:(0,o.jsx)(l,{endpoint:"/site-reviews/v1/shortcode/site_reviews_summary?option=assigned_users",label:(0,i._x)("Limit Reviews by Assigned Users","admin-text","site-reviews"),onChange:e=>s({assigned_users:e}),placeholder:(0,i._x)("Select a User...","admin-text","site-reviews"),value:t.assigned_users},"assigned_users"),terms:(0,o.jsx)(r.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,i._x)("Limit Reviews by Accepted Terms","admin-text","site-reviews"),onChange:e=>s({terms:e}),options:[{label:(0,i._x)("Select Review Terms...","admin-text","site-reviews"),value:""},{label:(0,i._x)("Terms were accepted","admin-text","site-reviews"),value:"true"},{label:(0,i._x)("Terms were not accepted","admin-text","site-reviews"),value:"false"}],value:t.terms},"terms"),rating:(0,o.jsx)(r.RangeControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,i._x)("Minimum Rating","admin-text","site-reviews"),min:GLSR.minrating,max:GLSR.maxrating,onChange:e=>s({rating:e}),value:t.rating},"rating"),schema:(0,o.jsxs)(r.__experimentalToggleGroupControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,help:(0,i._x)("The schema should only be enabled once on your page.","admin-text","site-reviews"),onChange:e=>s({schema:e}),label:(0,i._x)("Enable the Schema?","admin-text","site-reviews"),value:t.schema,children:[(0,o.jsx)(r.__experimentalToggleGroupControlOption,{value:!1,label:(0,i._x)("No","admin-text","site-reviews")}),(0,o.jsx)(r.__experimentalToggleGroupControlOption,{value:!0,label:(0,i._x)("Yes","admin-text","site-reviews")})]},"schema"),hide:(0,o.jsx)(d,{endpoint:"/site-reviews/v1/shortcode/site_reviews_summary?option=hide",label:(0,i._x)("Hide Options","admin-text","site-reviews"),onChange:e=>s({hide:e}),value:t.hide},"hide")},a={rating_field:(0,o.jsx)(r.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,help:(0,i._x)("Use the Review Forms addon to add custom rating fields.","admin-text","site-reviews"),label:(0,i._x)("Custom Rating Field Name","admin-text","site-reviews"),onChange:e=>s({rating_field:e}),value:t.rating_field},"rating_field"),id:(0,o.jsx)(r.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,help:(0,i._x)("This should be a unique value.","admin-text","site-reviews"),label:(0,i._x)("Custom ID","admin-text","site-reviews"),onChange:e=>s({id:e}),value:t.id},"id")};return(0,o.jsx)(v,{inspectorControls:n,inspectorAdvancedControls:a,name:"summary",props:e})},icon:(0,o.jsx)(_,{width:24,height:24})})}();