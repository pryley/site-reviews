!function(){"use strict";var e={n:function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(s,{a:s}),s},d:function(t,s){for(var n in s)e.o(s,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:s[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.wp.apiFetch,s=e.n(t),n=window.wp.data;const i="site-reviews";if(!(0,n.select)(i)){const e={options:{},selectedValues:{},suggestedValues:{}},t={setOptions:(e,t)=>({type:"SET_OPTIONS",endpoint:e,options:t}),setSelectedValues:(e,t)=>({type:"SET_SELECTED_VALUES",endpoint:e,selectedValues:t}),setSuggestedValues:(e,t)=>({type:"SET_SUGGESTED_VALUES",endpoint:e,suggestedValues:t})},s=(t=e,s)=>{switch(s.type){case"SET_OPTIONS":return{...t,options:{...t.options,[s.endpoint]:s.options}};case"SET_SELECTED_VALUES":return{...t,selectedValues:{...t.selectedValues,[s.endpoint]:s.selectedValues}};case"SET_SUGGESTED_VALUES":return{...t,suggestedValues:{...t.suggestedValues,[s.endpoint]:s.suggestedValues}};default:return t}},a={getOptions:(e,t)=>e.options[t]||[],getSelectedValues:(e,t)=>e.selectedValues[t]||[],getSuggestedValues:(e,t)=>e.suggestedValues[t]||[]},o=(0,n.createReduxStore)(i,{reducer:s,actions:t,selectors:a,controls:{}});(0,n.register)(o)}var a,o=i,r=window.wp.i18n,l=window.wp.components,d=window.wp.element,c=window.ReactJSXRuntime,p=({endpoint:e,hideIfEmpty:t=!1,placeholder:i,...a})=>{const[p,u]=(0,d.useState)(!1),g=(0,n.useSelect)((t=>t(o).getOptions(e)),[]),{options:h,...x}=a,{setOptions:m}=(0,n.useDispatch)(o);return(0,d.useEffect)((()=>{g.length||(u(!0),s()({path:e}).then((t=>{const s=t.map((e=>({label:e.title,value:String(e.id)})));m(e,s)})).finally((()=>{u(!1)})))}),[]),(0,c.jsx)(c.Fragment,{children:(!t||g.length>1)&&(0,c.jsx)(l.Animate,{type:p&&"loading",children:({className:e})=>(0,c.jsx)(l.BaseControl,{__nextHasNoMarginBottom:!0,children:(0,c.jsx)(l.ComboboxControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,allowReset:!0,className:e,expandOnFocus:!1,options:g,placeholder:i||(0,r._x)("Select...","admin-text","site-reviews"),...x})})})})},u=window.wp.url,g=window.wp.compose,h=({endpoint:e,help:t,label:i,onChange:a,placeholder:p,prefetch:h=!1,value:x})=>{const[m,_]=(0,d.useState)(!1),[v,w]=(0,d.useState)(!1),[f,S]=(0,d.useState)(""),[b,y]=(0,d.useState)(new Map),C=(0,d.useRef)(!1),j=(0,d.useRef)(!0),E=(0,n.useSelect)((t=>t(o).getSelectedValues(e)),[]),T=(0,n.useSelect)((t=>t(o).getSuggestedValues(e)),[]),{setSelectedValues:V,setSuggestedValues:O}=(0,n.useDispatch)(o),N=()=>({path:(0,u.addQueryArgs)(e,{include:x.join(","),search:f})}),R=(0,g.useDebounce)(S,500),L=e=>({id:e.id,title:e.title,value:isNaN(parseFloat(e.id))?e.title:`${e.title} (${e.id})`}),M=t=>{t.map(((e,s)=>{if("string"==typeof e){const n=T.find((t=>t.value===e));n&&(t[s]=n)}return e})),V(e,t),a(t.map((e=>e.id)))},B=({item:e})=>{const t=b.get(e);if(!t)return null;const{id:s,title:n}=t,i=(e=>{const t=f.toLocaleLowerCase();if(0===t.length)return null;const s=e.toLocaleLowerCase().indexOf(t);return{afterMatch:e.substring(s+t.length),beforeMatch:e.substring(0,s),match:e.substring(s,s+t.length)}})(n);return(0,c.jsxs)(l.__experimentalHStack,{children:[i?(0,c.jsxs)("span",{"aria-label":n,children:[i.beforeMatch,(0,c.jsx)("strong",{className:"components-form-token-field__suggestion-match",children:i.match}),i.afterMatch]}):(0,c.jsx)(l.__experimentalText,{color:"inherit",children:n}),(0,c.jsx)(l.__experimentalText,{color:"inherit",size:"small",style:{opacity:"0.5"},children:String(s)})]})},D=e=>T.some((t=>t.value===e));return(0,d.useEffect)((()=>{(async()=>{C.current||(T.length||!x.length&&!1===h?C.current=!0:(_(!0),s()(N()).then((t=>{C.current=!0;const s=[],n=[];t.forEach((e=>{s.push(L(e)),x.includes(e.id)&&n.push(L(e))})),V(e,n),O(e,s)})).finally((()=>{_(!1)}))))})()}),[]),(0,d.useEffect)((()=>{(async()=>{f.length<2||(j.current?j.current=!1:(w(!0),s()(N()).then((t=>{O(e,t.map(L))})).finally((()=>{w(!1)}))))})()}),[f]),(0,d.useEffect)((()=>{y(new Map(T.map((e=>[e.value,e]))))}),[T]),(0,c.jsxs)(l.BaseControl,{__nextHasNoMarginBottom:!0,children:[(0,c.jsx)(l.Animate,{type:(m||v)&&"loading",children:({className:e})=>(0,c.jsx)(l.FormTokenField,{__experimentalExpandOnFocus:!0,__experimentalRenderItem:B,__experimentalShowHowTo:!1,__experimentalValidateInput:D,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,className:e,disabled:m,label:i||"",onChange:M,onInputChange:R,placeholder:p||(0,r._x)("Search...","admin-text","site-reviews"),suggestions:T.map((e=>e.value)),value:E})}),t&&(0,c.jsx)(l.__experimentalText,{variant:"muted",size:"small",children:t})]})},x=({endpoint:e,onChange:t,value:i,...a})=>{const[r,p]=(0,d.useState)(!1),u=(0,n.useSelect)((t=>t(o).getOptions(e)),[]),{baseControlProps:g,controlProps:h}=(0,l.useBaseControlProps)(a),{checked:x,label:__,...m}=h,{setOptions:_}=(0,n.useDispatch)(o);return(0,d.useEffect)((()=>{u.length||(p(!0),s()({path:e}).then((t=>{const s=t.map((e=>({label:e.title,value:String(e.id)})));_(e,s)})).finally((()=>{p(!1)})))}),[]),(0,c.jsxs)(l.BaseControl,{__nextHasNoMarginBottom:!0,...g,children:[!r&&u.map((e=>(0,c.jsx)(l.ToggleControl,{__nextHasNoMarginBottom:!0,label:e.label,checked:i.includes(e.value),onChange:s=>((e,s)=>{const n=s?[...i,e]:i.filter((t=>t!==e));t(n)})(e.value,s),...m},e.value))),r&&(0,c.jsx)(l.Spinner,{})]})},m=e=>(0,c.jsxs)(l.__experimentalToggleGroupControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,...e,children:[(0,c.jsx)(l.__experimentalToggleGroupControlOption,{value:!1,label:(0,r._x)("No","admin-text","site-reviews")}),(0,c.jsx)(l.__experimentalToggleGroupControlOption,{value:!0,label:(0,r._x)("Yes","admin-text","site-reviews")})]}),_=window.wp.serverSideRender,v=e.n(_),w=window.wp.blockEditor,f=({className:e="ssr",inspectorAdvancedControls:t={},inspectorControls:s={},name:n,namespace:i="site-reviews",props:a,renderCallback:o})=>{const{attributes:p}=a,u=(0,d.useRef)(null),g=(0,d.useCallback)((t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)if("DIV"===t.tagName&&t.classList.contains(e)){if("function"==typeof o){const e=t.firstElementChild;e.classList.add("glsr-"+window.getComputedStyle(e,null).getPropertyValue("direction")),o(t,u.current)}return}}),[o]);(0,d.useEffect)((()=>{if(!u.current)return;const e=new MutationObserver(g);return e.observe(u.current,{childList:!0,subtree:!0}),()=>e.disconnect()}),[g]);const h={panel_settings:(0,c.jsx)(l.PanelBody,{title:(0,r._x)("Settings","admin-text","site-reviews"),children:Object.values(wp.hooks.applyFilters(`${i}.${n}.InspectorControls`,s,a))})};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(w.InspectorControls,{children:Object.values(wp.hooks.applyFilters(`${i}.${n}.InspectorPanels`,h,a))}),(0,c.jsx)(w.InspectorAdvancedControls,{children:Object.values(wp.hooks.applyFilters(`${i}.${n}.InspectorAdvancedControls`,t,a))}),(0,c.jsx)("div",{...(0,w.useBlockProps)({ref:u}),children:(0,c.jsx)(l.Disabled,{isDisabled:!0,children:(0,c.jsx)(v(),{attributes:p,block:`${i}/${n}`,className:e,skipBlockSupportAttributes:!0})})})]})},S=JSON.parse('{"UU":"site-reviews/reviews"}'),b=window.wp.blocks,y=window.React;function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)({}).hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},C.apply(null,arguments)}const j=e=>y.createElement("svg",C({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},e),a||(a=y.createElement("path",{d:"M18.646 1.821a3.44 3.44 0 0 1 1.772.481 3.57 3.57 0 0 1 1.281 1.285 3.46 3.46 0 0 1 .479 1.775v8.126a3.5 3.5 0 0 1-.477 1.78 3.55 3.55 0 0 1-1.283 1.298 3.44 3.44 0 0 1-1.772.481h-6.28l-.064.052-6.144 4.914c-.392.304-.976.263-1.359-.066a1.18 1.18 0 0 1-.337-1.233l1.377-3.742h-.485a3.44 3.44 0 0 1-1.567-.369l-.206-.112A3.57 3.57 0 0 1 2.3 15.206a3.46 3.46 0 0 1-.479-1.775V5.362A3.46 3.46 0 0 1 2.3 3.587a3.57 3.57 0 0 1 1.281-1.285 3.44 3.44 0 0 1 1.772-.481h13.292zm0 1.5H5.354a1.94 1.94 0 0 0-1.01.273 2.07 2.07 0 0 0-.749.752 1.96 1.96 0 0 0-.273 1.016v8.069a1.96 1.96 0 0 0 .273 1.016 2.07 2.07 0 0 0 .749.752 1.94 1.94 0 0 0 1.01.273H7.99l-.371 1.009-1.275 3.464.103-.082 1.871-1.496 1.1-.88 1.955-1.564.263-.21.205-.164h6.806a1.94 1.94 0 0 0 1.01-.273c.315-.186.561-.435.747-.757a2 2 0 0 0 .275-1.029V5.362a1.96 1.96 0 0 0-.273-1.016 2.07 2.07 0 0 0-.749-.752 1.94 1.94 0 0 0-1.01-.273zm-6.582 1.4a.22.22 0 0 1 .211.144l1.106 2.648 2.873.229a.22.22 0 0 1 .198.157l.036.112a.22.22 0 0 1-.067.243l-2.167 1.861.665 2.792a.23.23 0 0 1-.085.238l-.13.072a.23.23 0 0 1-.252 0l-2.446-1.484-2.459 1.497a.23.23 0 0 1-.252 0l-.099-.067a.23.23 0 0 1-.085-.238l.647-2.81-2.167-1.861a.22.22 0 0 1-.081-.243l.036-.112a.22.22 0 0 1 .198-.157l2.873-.229 1.101-2.648a.23.23 0 0 1 .196-.144z"})));(0,b.registerBlockType)(S.UU,{edit:function(e){const{attributes:t,setAttributes:s}=e;s({post_id:jQuery("#post_ID").val()});const n={assigned_posts:(0,c.jsx)(h,{endpoint:"/site-reviews/v1/shortcode/site_reviews?option=assigned_posts",label:(0,r._x)("Limit Reviews by Assigned Pages","admin-text","site-reviews"),onChange:e=>s({assigned_posts:e}),placeholder:(0,r._x)("Search Pages...","admin-text","site-reviews"),prefetch:!0,value:t.assigned_posts},"assigned_posts"),assigned_terms:(0,c.jsx)(h,{endpoint:"/site-reviews/v1/shortcode/site_reviews?option=assigned_terms",label:(0,r._x)("Limit Reviews by Categories","admin-text","site-reviews"),onChange:e=>s({assigned_terms:e}),placeholder:(0,r._x)("Search Categories...","admin-text","site-reviews"),value:t.assigned_terms},"assigned_terms"),assigned_users:(0,c.jsx)(h,{endpoint:"/site-reviews/v1/shortcode/site_reviews?option=assigned_users",label:(0,r._x)("Limit Reviews by Assigned Users","admin-text","site-reviews"),onChange:e=>s({assigned_users:e}),placeholder:(0,r._x)("Search Users...","admin-text","site-reviews"),prefetch:!0,value:t.assigned_users},"assigned_users"),terms:(0,c.jsx)(p,{endpoint:"/site-reviews/v1/shortcode/site_reviews?option=terms",label:(0,r._x)("Limit Reviews by Accepted Terms","admin-text","site-reviews"),onChange:e=>s({terms:e}),placeholder:(0,r._x)("Select Review Terms...","admin-text","site-reviews"),value:t.terms},"terms"),type:(0,c.jsx)(p,{endpoint:"/site-reviews/v1/shortcode/site_reviews?option=type",hideIfEmpty:!0,label:(0,r._x)("Limit Reviews by Type","admin-text","site-reviews"),onChange:e=>s({type:e}),placeholder:(0,r._x)("Select a Review Type...","admin-text","site-reviews"),value:t.type},"type"),pagination:(0,c.jsx)(p,{endpoint:"/site-reviews/v1/shortcode/site_reviews?option=pagination",label:(0,r._x)("Pagination Type","admin-text","site-reviews"),onChange:e=>s({pagination:e}),placeholder:(0,r._x)("Select Pagination...","admin-text","site-reviews"),value:t.pagination},"pagination"),display:(0,c.jsx)(l.RangeControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,r._x)("Reviews Per Page","admin-text","site-reviews"),min:"1",max:"50",onChange:e=>s({display:e}),value:t.display},"display"),rating:(0,c.jsx)(l.RangeControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,r._x)("Minimum Rating","admin-text","site-reviews"),min:GLSR.minrating,max:GLSR.maxrating,onChange:e=>s({rating:e}),value:t.rating},"rating"),schema:(0,c.jsx)(m,{help:(0,r._x)("The schema should only be enabled once on your page.","admin-text","site-reviews"),onChange:e=>s({schema:e}),label:(0,r._x)("Enable the Schema?","admin-text","site-reviews"),value:t.schema},"schema"),hide:(0,c.jsx)(x,{endpoint:"/site-reviews/v1/shortcode/site_reviews?option=hide",label:(0,r._x)("Hide Options","admin-text","site-reviews"),onChange:e=>s({hide:e}),value:t.hide},"hide")},i={id:(0,c.jsx)(l.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,help:(0,r._x)("This should be a unique value.","admin-text","site-reviews"),label:(0,r._x)("Custom ID","admin-text","site-reviews"),onChange:e=>s({id:e}),value:t.id},"id")};return(0,c.jsx)(f,{inspectorControls:n,inspectorAdvancedControls:i,name:"reviews",props:e})},icon:(0,c.jsx)(j,{width:24,height:24})})}();