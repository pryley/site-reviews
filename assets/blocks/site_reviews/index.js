!function(){"use strict";var e,t={n:function(e){var s=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(s,{a:s}),s},d:function(e,s){for(var n in s)t.o(s,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:s[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},s=window.wp.apiFetch,n=t.n(s),i=window.wp.i18n,a=window.wp.components,o=window.wp.element,r=window.ReactJSXRuntime,l=({endpoint:e,onChange:t,placeholder:s,value:l,...c})=>{const[d,p]=(0,o.useState)(!1),[u,x]=(0,o.useState)([]),m=(0,o.useRef)(!0),w=Object.fromEntries(Object.entries(c).filter((([e])=>!["onChange","placeholder","value"].includes(e)))),v=async(t="")=>{p(!0);try{const s=new URL(e,window.location.origin);s.searchParams.set("include",l.join(",")),s.searchParams.set("search",t);const i=await n()({path:s.pathname+s.search});if(m.current){if(!Array.isArray(i)||0===i.length)throw new Error("Invalid or empty response from API");x(i)}}catch(e){console.error("Error fetching options:",e)}finally{m.current&&p(!1)}};return(0,o.useEffect)((()=>(v(),()=>{m.current=!1})),[]),(0,r.jsx)(a.BaseControl,{__nextHasNoMarginBottom:!0,children:(0,r.jsx)(a.FormTokenField,{__experimentalExpandOnFocus:!0,__experimentalShowHowTo:!1,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,onChange:e=>{const s=e.map((e=>{const t=u.find((t=>t.title===e));return t?t.id:null})).filter((e=>null!==e));t(s)},onInputChange:v,placeholder:d?(0,i._x)("Loading...","admin-text","site-reviews"):s||(0,i._x)("Select...","admin-text","site-reviews"),suggestions:u.map((e=>e.title)),value:l.map((e=>{const t=u.find((t=>t.id===e));return t?t.title:""})).filter((e=>""!==e)),...w})})},c=window.wp.data,d=({endpoint:e,onChange:t,value:s=[],...i})=>{const[l,d]=(0,o.useState)(!1),{baseControlProps:p,controlProps:u}=(0,a.useBaseControlProps)(i),{setOptions:x}=(0,c.useDispatch)("site-reviews"),m=(0,c.useSelect)((t=>t("site-reviews").getOptions(e)),[e]),w=Object.fromEntries(Object.entries(u).filter((([e])=>!["label","checked","onChange","value"].includes(e))));return(0,o.useEffect)((()=>{m||(async()=>{d(!0);try{const t=new URL(e,window.location.origin),s=await n()({path:t.pathname+t.search});if(!Array.isArray(s)||0===s.length)throw new Error("Invalid or empty response from API");const i=s.map((e=>({label:e.title,value:e.id})));x(e,i)}catch(e){console.error("Error fetching options:",e)}finally{d(!1)}})()}),[e,m,x]),(0,r.jsxs)(a.BaseControl,{__nextHasNoMarginBottom:!0,...p,children:[l&&(0,r.jsx)(a.Spinner,{}),!l&&m&&m.map((e=>(0,r.jsx)(a.ToggleControl,{__nextHasNoMarginBottom:!0,label:e.label,checked:s.includes(e.value),onChange:n=>((e,n)=>{const i=n?[...s,e]:s.filter((t=>t!==e));t(i)})(e.value,n),...w},e.value)))]})},p=window.wp.serverSideRender,u=t.n(p),x=window.wp.blockEditor,m=({className:e="ssr",inspectorAdvancedControls:t={},inspectorControls:s={},name:n,namespace:l="site-reviews",props:c,renderCallback:d})=>{const{attributes:p}=c,m=(0,o.useRef)(null),w=(0,o.useCallback)((t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)if("DIV"===t.tagName&&t.classList.contains(e)){if("function"==typeof d){const e=t.firstElementChild;e.classList.add("glsr-"+window.getComputedStyle(e,null).getPropertyValue("direction")),d(t,m.current)}return}}),[d]);(0,o.useEffect)((()=>{if(!m.current)return;const e=new MutationObserver(w);return e.observe(m.current,{childList:!0,subtree:!0}),()=>e.disconnect()}),[w]);const v={panel_settings:(0,r.jsx)(a.PanelBody,{title:(0,i._x)("Settings","admin-text","site-reviews"),children:Object.values(wp.hooks.applyFilters(`${l}.${n}.InspectorControls`,s,c))})};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.InspectorControls,{children:Object.values(wp.hooks.applyFilters(`${l}.${n}.InspectorPanels`,v,c))}),(0,r.jsx)(x.InspectorAdvancedControls,{children:Object.values(wp.hooks.applyFilters(`${l}.${n}.InspectorAdvancedControls`,t,c))}),(0,r.jsx)("div",{...(0,x.useBlockProps)({ref:m}),children:(0,r.jsx)(a.Disabled,{isDisabled:!0,children:(0,r.jsx)(u(),{attributes:p,block:`${l}/${n}`,className:e,skipBlockSupportAttributes:!0})})})]})},w=JSON.parse('{"UU":"site-reviews/reviews"}'),v=window.wp.blocks,g=window.React;function h(){return h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)({}).hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},h.apply(null,arguments)}const _=t=>g.createElement("svg",h({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},t),e||(e=g.createElement("path",{d:"M18.646 1.821a3.44 3.44 0 0 1 1.772.481 3.57 3.57 0 0 1 1.281 1.285 3.46 3.46 0 0 1 .479 1.775v8.126a3.5 3.5 0 0 1-.477 1.78 3.55 3.55 0 0 1-1.283 1.298 3.44 3.44 0 0 1-1.772.481h-6.28l-.064.052-6.144 4.914c-.392.304-.976.263-1.359-.066a1.18 1.18 0 0 1-.337-1.233l1.377-3.742h-.485a3.44 3.44 0 0 1-1.567-.369l-.206-.112A3.57 3.57 0 0 1 2.3 15.206a3.46 3.46 0 0 1-.479-1.775V5.362A3.46 3.46 0 0 1 2.3 3.587a3.57 3.57 0 0 1 1.281-1.285 3.44 3.44 0 0 1 1.772-.481h13.292zm0 1.5H5.354a1.94 1.94 0 0 0-1.01.273 2.07 2.07 0 0 0-.749.752 1.96 1.96 0 0 0-.273 1.016v8.069a1.96 1.96 0 0 0 .273 1.016 2.07 2.07 0 0 0 .749.752 1.94 1.94 0 0 0 1.01.273H7.99l-.371 1.009-1.275 3.464.103-.082 1.871-1.496 1.1-.88 1.955-1.564.263-.21.205-.164h6.806a1.94 1.94 0 0 0 1.01-.273c.315-.186.561-.435.747-.757a2 2 0 0 0 .275-1.029V5.362a1.96 1.96 0 0 0-.273-1.016 2.07 2.07 0 0 0-.749-.752 1.94 1.94 0 0 0-1.01-.273zm-6.582 1.4a.22.22 0 0 1 .211.144l1.106 2.648 2.873.229a.22.22 0 0 1 .198.157l.036.112a.22.22 0 0 1-.067.243l-2.167 1.861.665 2.792a.23.23 0 0 1-.085.238l-.13.072a.23.23 0 0 1-.252 0l-2.446-1.484-2.459 1.497a.23.23 0 0 1-.252 0l-.099-.067a.23.23 0 0 1-.085-.238l.647-2.81-2.167-1.861a.22.22 0 0 1-.081-.243l.036-.112a.22.22 0 0 1 .198-.157l2.873-.229 1.101-2.648a.23.23 0 0 1 .196-.144z"}))),b={cachedOptions:{}},f={setOptions(e,t){return{type:"SET_OPTIONS",endpoint:e,options:t}}},C={getOptions(e,t){return e.cachedOptions[t]||null}};(0,c.select)("site-reviews")||(0,c.registerStore)("site-reviews",{actions:f,reducer:(e=b,t)=>"SET_OPTIONS"===t.type?{...e,cachedOptions:{...e.cachedOptions,[t.endpoint]:t.options}}:e,selectors:C}),(0,v.registerBlockType)(w.UU,{edit:function(e){const{attributes:t,setAttributes:s}=e;s({post_id:jQuery("#post_ID").val()});const n={assigned_posts:(0,r.jsx)(l,{endpoint:"/site-reviews/v1/shortcode/site_reviews?option=assigned_posts",label:(0,i._x)("Limit Reviews by Assigned Pages","admin-text","site-reviews"),onChange:e=>s({assigned_posts:e}),placeholder:(0,i._x)("Select a Page...","admin-text","site-reviews"),value:t.assigned_posts},"assigned_posts"),assigned_terms:(0,r.jsx)(l,{endpoint:"/site-reviews/v1/shortcode/site_reviews?option=assigned_terms",label:(0,i._x)("Limit Reviews by Categories","admin-text","site-reviews"),onChange:e=>s({assigned_terms:e}),placeholder:(0,i._x)("Select a Category...","admin-text","site-reviews"),value:t.assigned_terms},"assigned_terms"),assigned_users:(0,r.jsx)(l,{endpoint:"/site-reviews/v1/shortcode/site_reviews?option=assigned_users",label:(0,i._x)("Limit Reviews by Assigned Users","admin-text","site-reviews"),onChange:e=>s({assigned_users:e}),placeholder:(0,i._x)("Select a User...","admin-text","site-reviews"),value:t.assigned_users},"assigned_users"),terms:(0,r.jsx)(a.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,i._x)("Limit Reviews by Accepted Terms","admin-text","site-reviews"),onChange:e=>s({terms:e}),options:[{label:(0,i._x)("Select Review Terms...","admin-text","site-reviews"),value:""},{label:(0,i._x)("Terms were accepted","admin-text","site-reviews"),value:"true"},{label:(0,i._x)("Terms were not accepted","admin-text","site-reviews"),value:"false"}],value:t.terms},"terms"),pagination:(0,r.jsx)(a.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,i._x)("Pagination Type","admin-text","site-reviews"),onChange:e=>s({pagination:e}),options:[{label:(0,i._x)("No Pagination","admin-text","site-reviews"),value:""},{label:(0,i._x)("Load More Button","admin-text","site-reviews"),value:"loadmore"},{label:(0,i._x)("Pagination Links (AJAX)","admin-text","site-reviews"),value:"ajax"},{label:(0,i._x)("Pagination Links (with page reload)","admin-text","site-reviews"),value:"true"}],value:t.pagination},"pagination"),display:(0,r.jsx)(a.RangeControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,i._x)("Reviews Per Page","admin-text","site-reviews"),min:"1",max:"50",onChange:e=>s({display:e}),value:t.display},"display"),rating:(0,r.jsx)(a.RangeControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,i._x)("Minimum Rating","admin-text","site-reviews"),min:GLSR.minrating,max:GLSR.maxrating,onChange:e=>s({rating:e}),value:t.rating},"rating"),schema:(0,r.jsxs)(a.__experimentalToggleGroupControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,help:(0,i._x)("The schema should only be enabled once on your page.","admin-text","site-reviews"),onChange:e=>s({schema:e}),label:(0,i._x)("Enable the Schema?","admin-text","site-reviews"),value:t.schema,children:[(0,r.jsx)(a.__experimentalToggleGroupControlOption,{value:!1,label:(0,i._x)("No","admin-text","site-reviews")}),(0,r.jsx)(a.__experimentalToggleGroupControlOption,{value:!0,label:(0,i._x)("Yes","admin-text","site-reviews")})]},"schema"),hide:(0,r.jsx)(d,{endpoint:"/site-reviews/v1/shortcode/site_reviews?option=hide",label:(0,i._x)("Hide Options","admin-text","site-reviews"),onChange:e=>s({hide:e}),value:t.hide},"hide")},o={id:(0,r.jsx)(a.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,help:(0,i._x)("This should be a unique value.","admin-text","site-reviews"),label:(0,i._x)("Custom ID","admin-text","site-reviews"),onChange:e=>s({id:e}),value:t.id},"id")};return(0,r.jsx)(m,{inspectorControls:n,inspectorAdvancedControls:o,name:"reviews",props:e})},icon:(0,r.jsx)(_,{width:24,height:24})})}();