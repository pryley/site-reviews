!function(){"use strict";var e={n:function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(s,{a:s}),s},d:function(t,s){for(var n in s)e.o(s,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:s[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.wp.apiFetch,s=e.n(t),n=window.wp.data;const i="site-reviews";if(!(0,n.select)(i)){const e={options:{},selectedValues:{},suggestedValues:{}},t={setOptions:(e,t)=>({type:"SET_OPTIONS",endpoint:e,options:t}),setSelectedValues:(e,t)=>({type:"SET_SELECTED_VALUES",endpoint:e,selectedValues:t}),setSuggestedValues:(e,t)=>({type:"SET_SUGGESTED_VALUES",endpoint:e,suggestedValues:t})},s=(t=e,s)=>{switch(s.type){case"SET_OPTIONS":return{...t,options:{...t.options,[s.endpoint]:s.options}};case"SET_SELECTED_VALUES":return{...t,selectedValues:{...t.selectedValues,[s.endpoint]:s.selectedValues}};case"SET_SUGGESTED_VALUES":return{...t,suggestedValues:{...t.suggestedValues,[s.endpoint]:s.suggestedValues}};default:return t}},a={getOptions:(e,t)=>e.options[t]||[],getSelectedValues:(e,t)=>e.selectedValues[t]||[],getSuggestedValues:(e,t)=>e.suggestedValues[t]||[]},r=(0,n.createReduxStore)(i,{reducer:s,actions:t,selectors:a,controls:{}});(0,n.register)(r)}var a,r=i,o=window.wp.i18n,l=window.wp.components,c=window.wp.url,d=window.wp.compose,u=window.wp.element,p=window.ReactJSXRuntime,h=({endpoint:e,help:t,label:i,onChange:a,placeholder:h,prefetch:g=!1,value:w})=>{const[_,v]=(0,u.useState)(!1),[m,x]=(0,u.useState)(!1),[f,S]=(0,u.useState)(""),[b,C]=(0,u.useState)(new Map),j=(0,u.useRef)(!1),E=(0,u.useRef)(!0),y=(0,n.useSelect)((t=>t(r).getSelectedValues(e)),[]),V=(0,n.useSelect)((t=>t(r).getSuggestedValues(e)),[]),{setSelectedValues:O,setSuggestedValues:T}=(0,n.useDispatch)(r),k=()=>({path:(0,c.addQueryArgs)(e,{include:w.join(","),search:f})}),L=(0,d.useDebounce)(S,500),N=e=>({id:e.id,title:e.title,value:isNaN(parseFloat(e.id))?e.title:`${e.title} (${e.id})`}),D=t=>{t.map(((e,s)=>{if("string"==typeof e){const n=V.find((t=>t.value===e));n&&(t[s]=n)}return e})),O(e,t),a(t.map((e=>e.id)))},M=({item:e})=>{const t=b.get(e);if(!t)return null;const{id:s,title:n}=t,i=(e=>{const t=f.toLocaleLowerCase();if(0===t.length)return null;const s=e.toLocaleLowerCase().indexOf(t);return{afterMatch:e.substring(s+t.length),beforeMatch:e.substring(0,s),match:e.substring(s,s+t.length)}})(n);return(0,p.jsxs)(l.__experimentalHStack,{children:[i?(0,p.jsxs)("span",{"aria-label":n,children:[i.beforeMatch,(0,p.jsx)("strong",{className:"components-form-token-field__suggestion-match",children:i.match}),i.afterMatch]}):(0,p.jsx)(l.__experimentalText,{color:"inherit",children:n}),(0,p.jsx)(l.__experimentalText,{color:"inherit",size:"small",style:{opacity:"0.5"},children:String(s)})]})},R=e=>V.some((t=>t.value===e));return(0,u.useEffect)((()=>{(async()=>{j.current||(V.length||!w.length&&!1===g?j.current=!0:(v(!0),s()(k()).then((t=>{j.current=!0;const s=[],n=[];t.forEach((e=>{s.push(N(e)),w.includes(e.id)&&n.push(N(e))})),O(e,n),T(e,s)})).finally((()=>{v(!1)}))))})()}),[]),(0,u.useEffect)((()=>{(async()=>{f.length<2||(E.current?E.current=!1:(x(!0),s()(k()).then((t=>{T(e,t.map(N))})).finally((()=>{x(!1)}))))})()}),[f]),(0,u.useEffect)((()=>{C(new Map(V.map((e=>[e.value,e]))))}),[V]),(0,p.jsxs)(l.BaseControl,{__nextHasNoMarginBottom:!0,children:[(0,p.jsx)(l.Animate,{type:(_||m)&&"loading",children:({className:e})=>(0,p.jsx)(l.FormTokenField,{__experimentalExpandOnFocus:!0,__experimentalRenderItem:M,__experimentalShowHowTo:!1,__experimentalValidateInput:R,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,className:e,disabled:_,label:i||"",onChange:D,onInputChange:L,placeholder:h||(0,o._x)("Search...","admin-text","site-reviews"),suggestions:V.map((e=>e.value)),value:y})}),t&&(0,p.jsx)(l.__experimentalText,{variant:"muted",size:"small",children:t})]})},g=({endpoint:e,onChange:t,value:i,...a})=>{const[o,c]=(0,u.useState)(!1),d=(0,n.useSelect)((t=>t(r).getOptions(e)),[]),{baseControlProps:h,controlProps:g}=(0,l.useBaseControlProps)(a),{checked:w,label:__,..._}=g,{setOptions:v}=(0,n.useDispatch)(r);return(0,u.useEffect)((()=>{d.length||(c(!0),s()({path:e}).then((t=>{const s=t.map((e=>({label:e.title,value:String(e.id)})));v(e,s)})).finally((()=>{c(!1)})))}),[]),(0,p.jsxs)(l.BaseControl,{__nextHasNoMarginBottom:!0,...h,children:[!o&&d.map((e=>(0,p.jsx)(l.ToggleControl,{__nextHasNoMarginBottom:!0,label:e.label,checked:i.includes(e.value),onChange:s=>((e,s)=>{const n=s?[...i,e]:i.filter((t=>t!==e));t(n)})(e.value,s),..._},e.value))),o&&(0,p.jsx)(l.Spinner,{})]})},w=window.wp.serverSideRender,_=e.n(w),v=window.wp.blockEditor,m=({className:e="ssr",inspectorAdvancedControls:t={},inspectorControls:s={},name:n,namespace:i="site-reviews",props:a,renderCallback:r})=>{const{attributes:c}=a,d=(0,u.useRef)(null),h=(0,u.useCallback)((t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)if("DIV"===t.tagName&&t.classList.contains(e)){if("function"==typeof r){const e=t.firstElementChild;e.classList.add("glsr-"+window.getComputedStyle(e,null).getPropertyValue("direction")),r(t,d.current)}return}}),[r]);(0,u.useEffect)((()=>{if(!d.current)return;const e=new MutationObserver(h);return e.observe(d.current,{childList:!0,subtree:!0}),()=>e.disconnect()}),[h]);const g={panel_settings:(0,p.jsx)(l.PanelBody,{title:(0,o._x)("Settings","admin-text","site-reviews"),children:Object.values(wp.hooks.applyFilters(`${i}.${n}.InspectorControls`,s,a))})};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(v.InspectorControls,{children:Object.values(wp.hooks.applyFilters(`${i}.${n}.InspectorPanels`,g,a))}),(0,p.jsx)(v.InspectorAdvancedControls,{children:Object.values(wp.hooks.applyFilters(`${i}.${n}.InspectorAdvancedControls`,t,a))}),(0,p.jsx)("div",{...(0,v.useBlockProps)({ref:d}),children:(0,p.jsx)(l.Disabled,{isDisabled:!0,children:(0,p.jsx)(_(),{attributes:c,block:`${i}/${n}`,className:e,skipBlockSupportAttributes:!0})})})]})},x=JSON.parse('{"UU":"site-reviews/form"}'),f=window.wp.blocks,S=window.React;function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)({}).hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},b.apply(null,arguments)}const C=e=>S.createElement("svg",b({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},e),a||(a=S.createElement("path",{d:"M9.506 19.714H3.351c-.43 0-.779.288-.779.643v1.286c0 .355.349.643.779.643h6.156c.43 0 .779-.288.779-.643v-1.286c0-.355-.349-.643-.779-.643zm11.187-7.286H3.306a.73.73 0 0 0-.735.723v4.339a.73.73 0 0 0 .735.723h17.388a.73.73 0 0 0 .735-.723v-4.339a.73.73 0 0 0-.735-.723zm0-3H3.306c-.406 0-.735.349-.735.78v-.06c0 .431.329.78.735.78h17.388c.406 0 .735-.349.735-.78v.06c0-.431-.329-.78-.735-.78zM5.831 1.714a.16.16 0 0 1 .151.103l.79 1.892 1.889.151 1.891-.151.787-1.892a.16.16 0 0 1 .14-.103h.107a.16.16 0 0 1 .151.103l.79 1.892 1.89.151 1.89-.151.787-1.892a.16.16 0 0 1 .14-.103h.107a.16.16 0 0 1 .151.103l.79 1.892 2.052.164a.16.16 0 0 1 .141.112l.026.08a.16.16 0 0 1-.048.173l-1.548 1.33.475 1.994a.16.16 0 0 1-.061.17l-.093.051a.16.16 0 0 1-.18 0L17.3 6.724l-1.756 1.069a.16.16 0 0 1-.18 0l-.071-.048a.16.16 0 0 1-.061-.17l.462-2.007-1.273-1.093-1.271 1.093.475 1.994a.16.16 0 0 1-.061.17l-.093.051a.16.16 0 0 1-.18 0l-1.747-1.06-1.756 1.069a.16.16 0 0 1-.18 0l-.071-.048a.16.16 0 0 1-.061-.17l.462-2.007-1.273-1.093-1.271 1.093.475 1.994a.16.16 0 0 1-.061.17l-.093.051a.16.16 0 0 1-.18 0L5.79 6.724l-1.757 1.07a.16.16 0 0 1-.18 0l-.071-.048a.16.16 0 0 1-.061-.17l.462-2.007-1.548-1.33a.16.16 0 0 1-.058-.173l.026-.08a.16.16 0 0 1 .141-.112l2.052-.164.787-1.892a.16.16 0 0 1 .14-.103h.107z"})));(0,f.registerBlockType)(x.UU,{edit:function(e){const{attributes:t,setAttributes:s}=e,n={assigned_posts:(0,p.jsx)(h,{endpoint:"/site-reviews/v1/shortcode/site_reviews_form?option=assigned_posts",label:(0,o._x)("Assign Reviews to Pages","admin-text","site-reviews"),onChange:e=>s({assigned_posts:e}),placeholder:(0,o._x)("Search Pages...","admin-text","site-reviews"),prefetch:!0,value:t.assigned_posts},"assigned_posts"),assigned_terms:(0,p.jsx)(h,{endpoint:"/site-reviews/v1/shortcode/site_reviews_form?option=assigned_terms",label:(0,o._x)("Assign Reviews to Categories","admin-text","site-reviews"),onChange:e=>s({assigned_terms:e}),placeholder:(0,o._x)("Search Categories...","admin-text","site-reviews"),value:t.assigned_terms},"assigned_terms"),assigned_users:(0,p.jsx)(h,{endpoint:"/site-reviews/v1/shortcode/site_reviews_form?option=assigned_users",label:(0,o._x)("Assign Reviews to Users","admin-text","site-reviews"),onChange:e=>s({assigned_users:e}),placeholder:(0,o._x)("Search Users...","admin-text","site-reviews"),prefetch:!0,value:t.assigned_users},"assigned_users"),hide:(0,p.jsx)(g,{endpoint:"/site-reviews/v1/shortcode/site_reviews_form?option=hide",label:(0,o._x)("Hide Options","admin-text","site-reviews"),onChange:e=>s({hide:e}),value:t.hide},"hide")},i={reviews_id:(0,p.jsx)(l.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,help:(0,o._x)("Enter the Custom ID of a reviews block, shortcode, or widget where the review should be displayed after submission.","admin-text","site-reviews"),label:(0,o._x)("Reviews ID","admin-text","site-reviews"),onChange:e=>s({reviews_id:e}),value:t.reviews_id},"reviews_id"),id:(0,p.jsx)(l.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,help:(0,o._x)("This should be a unique value.","admin-text","site-reviews"),label:(0,o._x)("Custom ID","admin-text","site-reviews"),onChange:e=>s({id:e}),value:t.id},"id")};return(0,p.jsx)(m,{inspectorControls:n,inspectorAdvancedControls:i,name:"form",props:e,renderCallback:()=>{var e;null!==(e=GLSR)&&void 0!==e&&e.stars&&(GLSR.stars.destroy(),GLSR.stars.init(".glsr-field-rating select",{clearable:!0}))}})},icon:(0,p.jsx)(C,{width:24,height:24})})}();